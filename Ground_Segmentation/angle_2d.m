function y = angle_2d(a)
  m = size(a,1);
##  if (a(2)==0)
##    if (a(1)>=0)
##      y=0;
##    else
##      y = 180;
##    endif   
##  elseif (a(1)==0)
##    if (a(2)>0)
##      y = 90;
##    else 
##      y = 270; 
##    endif
##  else
##    if (a(2)>0)
##      if (a(1)>0)
##        y = 180*atan(a(2)/a(1))/pi;
##      else
##        y = 180 + 180*atan(a(2)/a(1))/pi;
##      endif
##    else 
##      if (a(1)>0)
##        y = 360 + 180*atan(a(2)/a(1))/pi;
##      else
##        y = 180 + 180*atan(a(2)/a(1))/pi;
##      endif   
##    endif
##  endif
  y = ((a(:,2)==0).*((a(:,1)>=0)*0+180*(a(:,1)<0)))+((a(:,2)!=0).*(a(:,1)==0).*(90*(a(:,2)>0)+270*(a(:,2)<=0)))+((a(:,2)!=0).*(a(:,1)!=0).*((a(:,2)>0).*((180*atan(a(:,2)./a(:,1))/pi).*(a(:,1)>0)+(180*ones(m,1)+180*atan(a(:,2)./a(:,1))/pi).*(a(:,1)<=0))+(a(:,2)<=0).*((360*ones(m,1)+180*atan(a(:,2)./a(:,1))/pi).*(a(:,1)>0)+(180*ones(m,1)+180*atan(a(:,2)./a(:,1))/pi).*(a(:,1)<=0))));
endfunction 

